// auto generated by kmigrator
// KMIGRATOR:0028_auto_20201108_0955:IyBHZW5lcmF0ZWQgYnkgRGphbmdvIDMuMS4yIG9uIDIwMjAtMTEtMDggMDk6NTUKCmZyb20gZGphbmdvLmRiIGltcG9ydCBtaWdyYXRpb25zLCBtb2RlbHMKaW1wb3J0IGRqYW5nby5kYi5tb2RlbHMuZGVsZXRpb24KCgpjbGFzcyBNaWdyYXRpb24obWlncmF0aW9ucy5NaWdyYXRpb24pOgoKICAgIGRlcGVuZGVuY2llcyA9IFsKICAgICAgICAoJ19kamFuZ29fc2NoZW1hJywgJzAwMjdfYXV0b18yMDIwMTEwN18wODU0JyksCiAgICBdCgogICAgb3BlcmF0aW9ucyA9IFsKICAgICAgICBtaWdyYXRpb25zLkNyZWF0ZU1vZGVsKAogICAgICAgICAgICBuYW1lPSd0ZXN0aGlzdG9yeXJlY29yZCcsCiAgICAgICAgICAgIGZpZWxkcz1bCiAgICAgICAgICAgICAgICAoJ2RhdGUxX3V0YycsIG1vZGVscy5EYXRlVGltZUZpZWxkKGJsYW5rPVRydWUsIG51bGw9VHJ1ZSkpLAogICAgICAgICAgICAgICAgKCdkYXRlMV9vZmZzZXQnLCBtb2RlbHMuVGV4dEZpZWxkKGJsYW5rPVRydWUsIG51bGw9VHJ1ZSkpLAogICAgICAgICAgICAgICAgKCd1dGMnLCBtb2RlbHMuRGF0ZVRpbWVGaWVsZChibGFuaz1UcnVlLCBudWxsPVRydWUpKSwKICAgICAgICAgICAgICAgICgnZGF5JywgbW9kZWxzLkRhdGVGaWVsZChibGFuaz1UcnVlLCBudWxsPVRydWUpKSwKICAgICAgICAgICAgICAgICgnZmlsZScsIG1vZGVscy5KU09ORmllbGQoYmxhbms9VHJ1ZSwgbnVsbD1UcnVlKSksCiAgICAgICAgICAgICAgICAoJ3Bhc3NfZmllbGQnLCBtb2RlbHMuQ2hhckZpZWxkKGJsYW5rPVRydWUsIGRiX2NvbHVtbj0ncGFzcycsIG1heF9sZW5ndGg9NjAsIG51bGw9VHJ1ZSkpLAogICAgICAgICAgICAgICAgKCdoZXJvQ29sb3InLCBtb2RlbHMuVGV4dEZpZWxkKGJsYW5rPVRydWUsIG51bGw9VHJ1ZSkpLAogICAgICAgICAgICAgICAgKCdpc0VuYWJsZWQnLCBtb2RlbHMuQm9vbGVhbkZpZWxkKCkpLAogICAgICAgICAgICAgICAgKCdyYXRpbmcxJywgbW9kZWxzLkludGVnZXJGaWVsZCgpKSwKICAgICAgICAgICAgICAgICgncmF0aW5nMicsIG1vZGVscy5EZWNpbWFsRmllbGQoYmxhbms9VHJ1ZSwgZGVjaW1hbF9wbGFjZXM9MiwgbWF4X2RpZ2l0cz04LCBudWxsPVRydWUpKSwKICAgICAgICAgICAgICAgICgncmF0aW5nMycsIG1vZGVscy5EZWNpbWFsRmllbGQoYmxhbms9VHJ1ZSwgZGVjaW1hbF9wbGFjZXM9NCwgbWF4X2RpZ2l0cz0xOCwgbnVsbD1UcnVlKSksCiAgICAgICAgICAgICAgICAoJ3ZlbnVlJywgbW9kZWxzLkpTT05GaWVsZChibGFuaz1UcnVlLCBudWxsPVRydWUpKSwKICAgICAgICAgICAgICAgICgnc3RhdHVzX3JlbmFtZWQnLCBtb2RlbHMuQ2hhckZpZWxkKGNob2ljZXM9WygncGVuZGluZycsICdwZW5kaW5nJyksICgncHJvY2Vzc2VkJywgJ3Byb2Nlc3NlZCcpLCAoJ25vJywgJ25vJyldLCBtYXhfbGVuZ3RoPTUwKSksCiAgICAgICAgICAgICAgICAoJ3V1aWQnLCBtb2RlbHMuVVVJREZpZWxkKCkpLAogICAgICAgICAgICAgICAgKCd1cmwnLCBtb2RlbHMuVGV4dEZpZWxkKCkpLAogICAgICAgICAgICAgICAgKCdzbHVnJywgbW9kZWxzLlRleHRGaWVsZCh1bmlxdWU9VHJ1ZSkpLAogICAgICAgICAgICAgICAgKCdyYXRpbmcnLCBtb2RlbHMuSW50ZWdlckZpZWxkKGJsYW5rPVRydWUsIG51bGw9VHJ1ZSkpLAogICAgICAgICAgICAgICAgKCdzZXR0aW5ncycsIG1vZGVscy5KU09ORmllbGQoYmxhbms9VHJ1ZSwgbnVsbD1UcnVlKSksCiAgICAgICAgICAgICAgICAoJ21ldGEnLCBtb2RlbHMuSlNPTkZpZWxkKGJsYW5rPVRydWUsIG51bGw9VHJ1ZSkpLAogICAgICAgICAgICAgICAgKCd0ZXh0JywgbW9kZWxzLlRleHRGaWVsZChibGFuaz1UcnVlLCBudWxsPVRydWUpKSwKICAgICAgICAgICAgICAgICgndXBkYXRlZEF0X3V0YycsIG1vZGVscy5EYXRlVGltZUZpZWxkKGJsYW5rPVRydWUsIG51bGw9VHJ1ZSkpLAogICAgICAgICAgICAgICAgKCd1cGRhdGVkQXRfb2Zmc2V0JywgbW9kZWxzLlRleHRGaWVsZChibGFuaz1UcnVlLCBudWxsPVRydWUpKSwKICAgICAgICAgICAgICAgICgnY3JlYXRlZEF0X3V0YycsIG1vZGVscy5EYXRlVGltZUZpZWxkKGJsYW5rPVRydWUsIG51bGw9VHJ1ZSkpLAogICAgICAgICAgICAgICAgKCdjcmVhdGVkQXRfb2Zmc2V0JywgbW9kZWxzLlRleHRGaWVsZChibGFuaz1UcnVlLCBudWxsPVRydWUpKSwKICAgICAgICAgICAgICAgICgndicsIG1vZGVscy5JbnRlZ2VyRmllbGQoZGVmYXVsdD0xKSksCiAgICAgICAgICAgICAgICAoJ2lkJywgbW9kZWxzLlVVSURGaWVsZChwcmltYXJ5X2tleT1UcnVlLCBzZXJpYWxpemU9RmFsc2UpKSwKICAgICAgICAgICAgICAgICgnaGlzdG9yeV9kYXRlJywgbW9kZWxzLkRhdGVUaW1lRmllbGQoKSksCiAgICAgICAgICAgICAgICAoJ2hpc3RvcnlfYWN0aW9uJywgbW9kZWxzLkNoYXJGaWVsZChjaG9pY2VzPVsoJ2MnLCAnYycpLCAoJ3UnLCAndScpLCAoJ2QnLCAnZCcpXSwgbWF4X2xlbmd0aD01MCkpLAogICAgICAgICAgICAgICAgKCdjcmVhdGVkQnknLCBtb2RlbHMuRm9yZWlnbktleShibGFuaz1UcnVlLCBkYl9jb2x1bW49J2NyZWF0ZWRCeScsIG51bGw9VHJ1ZSwgb25fZGVsZXRlPWRqYW5nby5kYi5tb2RlbHMuZGVsZXRpb24uRE9fTk9USElORywgcmVsYXRlZF9uYW1lPScrJywgdG89J19kamFuZ29fc2NoZW1hLnVzZXInKSksCiAgICAgICAgICAgIF0sCiAgICAgICAgICAgIG9wdGlvbnM9ewogICAgICAgICAgICAgICAgJ2RiX3RhYmxlJzogJ1Rlc3RIaXN0b3J5UmVjb3JkJywKICAgICAgICAgICAgfSwKICAgICAgICApLAogICAgICAgIG1pZ3JhdGlvbnMuUmVuYW1lTW9kZWwoCiAgICAgICAgICAgIG9sZF9uYW1lPSd0ZXN0aXRlbV9oaXN0b3J5JywKICAgICAgICAgICAgbmV3X25hbWU9J3Rlc3RpdGVtaGlzdG9yeXJlY29yZCcsCiAgICAgICAgKSwKICAgICAgICBtaWdyYXRpb25zLlJlbW92ZUZpZWxkKAogICAgICAgICAgICBtb2RlbF9uYW1lPSd0ZXN0JywKICAgICAgICAgICAgbmFtZT0naGlzdG9yeScsCiAgICAgICAgKSwKICAgICAgICBtaWdyYXRpb25zLlJlbW92ZUZpZWxkKAogICAgICAgICAgICBtb2RlbF9uYW1lPSd0ZXN0aXRlbScsCiAgICAgICAgICAgIG5hbWU9J2hpc3RvcnknLAogICAgICAgICksCiAgICAgICAgbWlncmF0aW9ucy5BbHRlckZpZWxkKAogICAgICAgICAgICBtb2RlbF9uYW1lPSd0ZXN0JywKICAgICAgICAgICAgbmFtZT0nc3RhdHVzX3JlbmFtZWQnLAogICAgICAgICAgICBmaWVsZD1tb2RlbHMuQ2hhckZpZWxkKGNob2ljZXM9WygncGVuZGluZycsICdwZW5kaW5nJyksICgncHJvY2Vzc2VkJywgJ3Byb2Nlc3NlZCcpLCAoJ25vJywgJ25vJyldLCBtYXhfbGVuZ3RoPTUwKSwKICAgICAgICApLAogICAgICAgIG1pZ3JhdGlvbnMuQWx0ZXJNb2RlbFRhYmxlKAogICAgICAgICAgICBuYW1lPSd0ZXN0aXRlbWhpc3RvcnlyZWNvcmQnLAogICAgICAgICAgICB0YWJsZT0nVGVzdEl0ZW1IaXN0b3J5UmVjb3JkJywKICAgICAgICApLAogICAgICAgIG1pZ3JhdGlvbnMuQWRkRmllbGQoCiAgICAgICAgICAgIG1vZGVsX25hbWU9J3Rlc3RoaXN0b3J5cmVjb3JkJywKICAgICAgICAgICAgbmFtZT0naGlzdG9yeV9pZCcsCiAgICAgICAgICAgIGZpZWxkPW1vZGVscy5Gb3JlaWduS2V5KGJsYW5rPVRydWUsIGRiX2NvbHVtbj0naGlzdG9yeV9pZCcsIGRiX2NvbnN0cmFpbnQ9RmFsc2UsIG9uX2RlbGV0ZT1kamFuZ28uZGIubW9kZWxzLmRlbGV0aW9uLkRPX05PVEhJTkcsIHJlbGF0ZWRfbmFtZT0nKycsIHRvPSdfZGphbmdvX3NjaGVtYS50ZXN0JyksCiAgICAgICAgKSwKICAgICAgICBtaWdyYXRpb25zLkFkZEZpZWxkKAogICAgICAgICAgICBtb2RlbF9uYW1lPSd0ZXN0aGlzdG9yeXJlY29yZCcsCiAgICAgICAgICAgIG5hbWU9J3NlbGYnLAogICAgICAgICAgICBmaWVsZD1tb2RlbHMuRm9yZWlnbktleShibGFuaz1UcnVlLCBkYl9jb2x1bW49J3NlbGYnLCBudWxsPVRydWUsIG9uX2RlbGV0ZT1kamFuZ28uZGIubW9kZWxzLmRlbGV0aW9uLkRPX05PVEhJTkcsIHJlbGF0ZWRfbmFtZT0nKycsIHRvPSdfZGphbmdvX3NjaGVtYS50ZXN0JyksCiAgICAgICAgKSwKICAgICAgICBtaWdyYXRpb25zLkFkZEZpZWxkKAogICAgICAgICAgICBtb2RlbF9uYW1lPSd0ZXN0aGlzdG9yeXJlY29yZCcsCiAgICAgICAgICAgIG5hbWU9J3VwZGF0ZWRCeScsCiAgICAgICAgICAgIGZpZWxkPW1vZGVscy5Gb3JlaWduS2V5KGJsYW5rPVRydWUsIGRiX2NvbHVtbj0ndXBkYXRlZEJ5JywgbnVsbD1UcnVlLCBvbl9kZWxldGU9ZGphbmdvLmRiLm1vZGVscy5kZWxldGlvbi5ET19OT1RISU5HLCByZWxhdGVkX25hbWU9JysnLCB0bz0nX2RqYW5nb19zY2hlbWEudXNlcicpLAogICAgICAgICksCiAgICAgICAgbWlncmF0aW9ucy5EZWxldGVNb2RlbCgKICAgICAgICAgICAgbmFtZT0ndGVzdF9oaXN0b3J5JywKICAgICAgICApLAogICAgXQo=

exports.up = async (knex) => {
    await knex.raw(`
    BEGIN;
--
-- Create model testhistoryrecord
--
CREATE TABLE "TestHistoryRecord" ("date1_utc" timestamp with time zone NULL, "date1_offset" text NULL, "utc" timestamp with time zone NULL, "day" date NULL, "file" jsonb NULL, "pass" varchar(60) NULL, "heroColor" text NULL, "isEnabled" boolean NOT NULL, "rating1" integer NOT NULL, "rating2" numeric(8, 2) NULL, "rating3" numeric(18, 4) NULL, "venue" jsonb NULL, "status_renamed" varchar(50) NOT NULL, "uuid" uuid NOT NULL, "url" text NOT NULL, "slug" text NOT NULL UNIQUE, "rating" integer NULL, "settings" jsonb NULL, "meta" jsonb NULL, "text" text NULL, "updatedAt_utc" timestamp with time zone NULL, "updatedAt_offset" text NULL, "createdAt_utc" timestamp with time zone NULL, "createdAt_offset" text NULL, "v" integer NOT NULL, "id" uuid NOT NULL PRIMARY KEY, "history_date" timestamp with time zone NOT NULL, "history_action" varchar(50) NOT NULL, "createdBy" integer NULL);
--
-- Rename model testitem_history to testitemhistoryrecord
--
--
-- Remove field history from test
--
SET CONSTRAINTS "Test_history_6cd5696d_fk_Test_history_id" IMMEDIATE; ALTER TABLE "Test" DROP CONSTRAINT "Test_history_6cd5696d_fk_Test_history_id";
ALTER TABLE "Test" DROP COLUMN "history" CASCADE;
--
-- Remove field history from testitem
--
SET CONSTRAINTS "TestItem_history_2c0abe62_fk_TestItem_history_id" IMMEDIATE; ALTER TABLE "TestItem" DROP CONSTRAINT "TestItem_history_2c0abe62_fk_TestItem_history_id";
ALTER TABLE "TestItem" DROP COLUMN "history" CASCADE;
--
-- Alter field status_renamed on test
--
--
-- Rename table for testitemhistoryrecord to TestItemHistoryRecord
--
ALTER TABLE "TestItem_history" RENAME TO "TestItemHistoryRecord";
--
-- Add field history_id to testhistoryrecord
--
ALTER TABLE "TestHistoryRecord" ADD COLUMN "history_id" integer NOT NULL;
--
-- Add field self to testhistoryrecord
--
ALTER TABLE "TestHistoryRecord" ADD COLUMN "self" integer NULL CONSTRAINT "TestHistoryRecord_self_d09f530b_fk_Test_id" REFERENCES "Test"("id") DEFERRABLE INITIALLY DEFERRED; SET CONSTRAINTS "TestHistoryRecord_self_d09f530b_fk_Test_id" IMMEDIATE;
--
-- Add field updatedBy to testhistoryrecord
--
ALTER TABLE "TestHistoryRecord" ADD COLUMN "updatedBy" integer NULL CONSTRAINT "TestHistoryRecord_updatedBy_8429de21_fk_User_id" REFERENCES "User"("id") DEFERRABLE INITIALLY DEFERRED; SET CONSTRAINTS "TestHistoryRecord_updatedBy_8429de21_fk_User_id" IMMEDIATE;
--
-- Delete model test_history
--
DROP TABLE "Test_history" CASCADE;
ALTER TABLE "TestHistoryRecord" ADD CONSTRAINT "TestHistoryRecord_createdBy_85dfb4aa_fk_User_id" FOREIGN KEY ("createdBy") REFERENCES "User" ("id") DEFERRABLE INITIALLY DEFERRED;
CREATE INDEX "TestHistoryRecord_slug_25daa18b_like" ON "TestHistoryRecord" ("slug" text_pattern_ops);
CREATE INDEX "TestHistoryRecord_createdBy_85dfb4aa" ON "TestHistoryRecord" ("createdBy");
CREATE INDEX "TestHistoryRecord_history_id_9e99b381" ON "TestHistoryRecord" ("history_id");
CREATE INDEX "TestHistoryRecord_self_d09f530b" ON "TestHistoryRecord" ("self");
CREATE INDEX "TestHistoryRecord_updatedBy_8429de21" ON "TestHistoryRecord" ("updatedBy");
COMMIT;

    `)
}

exports.down = async (knex) => {
    await knex.raw(`
    BEGIN;
--
-- Delete model test_history
--
CREATE TABLE "Test_history" ("date1_utc" timestamp with time zone NULL, "date1_offset" text NULL, "utc" timestamp with time zone NULL, "day" date NULL, "file" jsonb NULL, "pass" varchar(60) NULL, "heroColor" text NULL, "isEnabled" boolean NOT NULL, "rating1" integer NOT NULL, "rating2" numeric(8, 2) NULL, "rating3" numeric(18, 4) NULL, "venue" jsonb NULL, "status_renamed" varchar(50) NOT NULL, "uuid" uuid NOT NULL, "url" text NOT NULL, "slug" text NOT NULL UNIQUE, "rating" integer NULL, "settings" jsonb NULL, "meta" jsonb NULL, "text" text NULL, "updatedAt_utc" timestamp with time zone NULL, "updatedAt_offset" text NULL, "createdAt_utc" timestamp with time zone NULL, "createdAt_offset" text NULL, "v" integer NOT NULL, "id" uuid NOT NULL PRIMARY KEY, "history_date" timestamp with time zone NOT NULL, "history_action" varchar(50) NOT NULL, "createdBy" integer NULL, "history_id" integer NOT NULL, "self" integer NULL, "updatedBy" integer NULL);
--
-- Add field updatedBy to testhistoryrecord
--
ALTER TABLE "TestHistoryRecord" DROP COLUMN "updatedBy" CASCADE;
--
-- Add field self to testhistoryrecord
--
ALTER TABLE "TestHistoryRecord" DROP COLUMN "self" CASCADE;
--
-- Add field history_id to testhistoryrecord
--
ALTER TABLE "TestHistoryRecord" DROP COLUMN "history_id" CASCADE;
--
-- Rename table for testitemhistoryrecord to TestItemHistoryRecord
--
ALTER TABLE "TestItemHistoryRecord" RENAME TO "TestItem_history";
--
-- Alter field status_renamed on test
--
--
-- Remove field history from testitem
--
ALTER TABLE "TestItem" ADD COLUMN "history" uuid NULL CONSTRAINT "TestItem_history_2c0abe62_fk_TestItem_history_id" REFERENCES "TestItem_history"("id") DEFERRABLE INITIALLY DEFERRED; SET CONSTRAINTS "TestItem_history_2c0abe62_fk_TestItem_history_id" IMMEDIATE;
--
-- Remove field history from test
--
ALTER TABLE "Test" ADD COLUMN "history" uuid NULL CONSTRAINT "Test_history_6cd5696d_fk_Test_history_id" REFERENCES "Test_history"("id") DEFERRABLE INITIALLY DEFERRED; SET CONSTRAINTS "Test_history_6cd5696d_fk_Test_history_id" IMMEDIATE;
--
-- Rename model testitem_history to testitemhistoryrecord
--
--
-- Create model testhistoryrecord
--
DROP TABLE "TestHistoryRecord" CASCADE;
ALTER TABLE "Test_history" ADD CONSTRAINT "Test_history_createdBy_a50667f1_fk_User_id" FOREIGN KEY ("createdBy") REFERENCES "User" ("id") DEFERRABLE INITIALLY DEFERRED;
ALTER TABLE "Test_history" ADD CONSTRAINT "Test_history_self_99994f16_fk_Test_id" FOREIGN KEY ("self") REFERENCES "Test" ("id") DEFERRABLE INITIALLY DEFERRED;
ALTER TABLE "Test_history" ADD CONSTRAINT "Test_history_updatedBy_1ad3a91d_fk_User_id" FOREIGN KEY ("updatedBy") REFERENCES "User" ("id") DEFERRABLE INITIALLY DEFERRED;
CREATE INDEX "Test_history_slug_55ce7738_like" ON "Test_history" ("slug" text_pattern_ops);
CREATE INDEX "Test_history_createdBy_a50667f1" ON "Test_history" ("createdBy");
CREATE INDEX "Test_history_history_id_6cc6b594" ON "Test_history" ("history_id");
CREATE INDEX "Test_history_self_99994f16" ON "Test_history" ("self");
CREATE INDEX "Test_history_updatedBy_1ad3a91d" ON "Test_history" ("updatedBy");
CREATE INDEX "TestItem_history_2c0abe62" ON "TestItem" ("history");
CREATE INDEX "Test_history_6cd5696d" ON "Test" ("history");
COMMIT;

    `)
}
