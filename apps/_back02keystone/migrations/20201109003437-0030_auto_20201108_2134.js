// auto generated by kmigrator
// KMIGRATOR:0030_auto_20201108_2134:IyBHZW5lcmF0ZWQgYnkgRGphbmdvIDMuMS4yIG9uIDIwMjAtMTEtMDggMjE6MzQKCmZyb20gZGphbmdvLmRiIGltcG9ydCBtaWdyYXRpb25zLCBtb2RlbHMKCgpjbGFzcyBNaWdyYXRpb24obWlncmF0aW9ucy5NaWdyYXRpb24pOgoKICAgIGRlcGVuZGVuY2llcyA9IFsKICAgICAgICAoJ19kamFuZ29fc2NoZW1hJywgJzAwMjlfYXV0b18yMDIwMTEwOF8xNTU5JyksCiAgICBdCgogICAgb3BlcmF0aW9ucyA9IFsKICAgICAgICBtaWdyYXRpb25zLkFkZEZpZWxkKAogICAgICAgICAgICBtb2RlbF9uYW1lPSd0ZXN0aGlzdG9yeXJlY29yZCcsCiAgICAgICAgICAgIG5hbWU9J3ZpcjEnLAogICAgICAgICAgICBmaWVsZD1tb2RlbHMuSlNPTkZpZWxkKGJsYW5rPVRydWUsIG51bGw9VHJ1ZSksCiAgICAgICAgKSwKICAgICAgICBtaWdyYXRpb25zLkFsdGVyRmllbGQoCiAgICAgICAgICAgIG1vZGVsX25hbWU9J3Rlc3RoaXN0b3J5cmVjb3JkJywKICAgICAgICAgICAgbmFtZT0naXNFbmFibGVkJywKICAgICAgICAgICAgZmllbGQ9bW9kZWxzLkJvb2xlYW5GaWVsZChibGFuaz1UcnVlLCBudWxsPVRydWUpLAogICAgICAgICksCiAgICAgICAgbWlncmF0aW9ucy5BbHRlckZpZWxkKAogICAgICAgICAgICBtb2RlbF9uYW1lPSd0ZXN0aGlzdG9yeXJlY29yZCcsCiAgICAgICAgICAgIG5hbWU9J3Bhc3NfZmllbGQnLAogICAgICAgICAgICBmaWVsZD1tb2RlbHMuVGV4dEZpZWxkKGJsYW5rPVRydWUsIGRiX2NvbHVtbj0ncGFzcycsIG51bGw9VHJ1ZSksCiAgICAgICAgKSwKICAgICAgICBtaWdyYXRpb25zLkFsdGVyRmllbGQoCiAgICAgICAgICAgIG1vZGVsX25hbWU9J3Rlc3RoaXN0b3J5cmVjb3JkJywKICAgICAgICAgICAgbmFtZT0ncmF0aW5nMScsCiAgICAgICAgICAgIGZpZWxkPW1vZGVscy5JbnRlZ2VyRmllbGQoYmxhbms9VHJ1ZSwgbnVsbD1UcnVlKSwKICAgICAgICApLAogICAgICAgIG1pZ3JhdGlvbnMuQWx0ZXJGaWVsZCgKICAgICAgICAgICAgbW9kZWxfbmFtZT0ndGVzdGhpc3RvcnlyZWNvcmQnLAogICAgICAgICAgICBuYW1lPSdzbHVnJywKICAgICAgICAgICAgZmllbGQ9bW9kZWxzLlRleHRGaWVsZChibGFuaz1UcnVlLCBudWxsPVRydWUpLAogICAgICAgICksCiAgICAgICAgbWlncmF0aW9ucy5BbHRlckZpZWxkKAogICAgICAgICAgICBtb2RlbF9uYW1lPSd0ZXN0aGlzdG9yeXJlY29yZCcsCiAgICAgICAgICAgIG5hbWU9J3N0YXR1c19yZW5hbWVkJywKICAgICAgICAgICAgZmllbGQ9bW9kZWxzLlRleHRGaWVsZChibGFuaz1UcnVlLCBudWxsPVRydWUpLAogICAgICAgICksCiAgICAgICAgbWlncmF0aW9ucy5BbHRlckZpZWxkKAogICAgICAgICAgICBtb2RlbF9uYW1lPSd0ZXN0aGlzdG9yeXJlY29yZCcsCiAgICAgICAgICAgIG5hbWU9J3VybCcsCiAgICAgICAgICAgIGZpZWxkPW1vZGVscy5UZXh0RmllbGQoYmxhbms9VHJ1ZSwgbnVsbD1UcnVlKSwKICAgICAgICApLAogICAgICAgIG1pZ3JhdGlvbnMuQWx0ZXJGaWVsZCgKICAgICAgICAgICAgbW9kZWxfbmFtZT0ndGVzdGhpc3RvcnlyZWNvcmQnLAogICAgICAgICAgICBuYW1lPSd1dWlkJywKICAgICAgICAgICAgZmllbGQ9bW9kZWxzLlVVSURGaWVsZChibGFuaz1UcnVlLCBudWxsPVRydWUpLAogICAgICAgICksCiAgICAgICAgbWlncmF0aW9ucy5BbHRlckZpZWxkKAogICAgICAgICAgICBtb2RlbF9uYW1lPSd0ZXN0aGlzdG9yeXJlY29yZCcsCiAgICAgICAgICAgIG5hbWU9J3YnLAogICAgICAgICAgICBmaWVsZD1tb2RlbHMuSW50ZWdlckZpZWxkKGJsYW5rPVRydWUsIG51bGw9VHJ1ZSksCiAgICAgICAgKSwKICAgICAgICBtaWdyYXRpb25zLkFsdGVyRmllbGQoCiAgICAgICAgICAgIG1vZGVsX25hbWU9J3Rlc3RpdGVtaGlzdG9yeXJlY29yZCcsCiAgICAgICAgICAgIG5hbWU9J21ldGEnLAogICAgICAgICAgICBmaWVsZD1tb2RlbHMuSlNPTkZpZWxkKGJsYW5rPVRydWUsIG51bGw9VHJ1ZSksCiAgICAgICAgKSwKICAgICAgICBtaWdyYXRpb25zLkFsdGVyRmllbGQoCiAgICAgICAgICAgIG1vZGVsX25hbWU9J3Rlc3RpdGVtaGlzdG9yeXJlY29yZCcsCiAgICAgICAgICAgIG5hbWU9J3YnLAogICAgICAgICAgICBmaWVsZD1tb2RlbHMuSW50ZWdlckZpZWxkKGJsYW5rPVRydWUsIG51bGw9VHJ1ZSksCiAgICAgICAgKSwKICAgIF0K

exports.up = async (knex) => {
    await knex.raw(`
    BEGIN;
--
-- Add field vir1 to testhistoryrecord
--
ALTER TABLE "TestHistoryRecord" ADD COLUMN "vir1" jsonb NULL;
--
-- Alter field isEnabled on testhistoryrecord
--
ALTER TABLE "TestHistoryRecord" ALTER COLUMN "isEnabled" DROP NOT NULL;
--
-- Alter field pass_field on testhistoryrecord
--
ALTER TABLE "TestHistoryRecord" ALTER COLUMN "pass" TYPE text USING "pass"::text;
--
-- Alter field rating1 on testhistoryrecord
--
ALTER TABLE "TestHistoryRecord" ALTER COLUMN "rating1" DROP NOT NULL;
--
-- Alter field slug on testhistoryrecord
--
ALTER TABLE "TestHistoryRecord" DROP CONSTRAINT "TestHistoryRecord_slug_key";
ALTER TABLE "TestHistoryRecord" ALTER COLUMN "slug" DROP NOT NULL;
DROP INDEX IF EXISTS "TestHistoryRecord_slug_25daa18b_like";
--
-- Alter field status_renamed on testhistoryrecord
--
ALTER TABLE "TestHistoryRecord" ALTER COLUMN "status_renamed" TYPE text USING "status_renamed"::text, ALTER COLUMN "status_renamed" DROP NOT NULL;
--
-- Alter field url on testhistoryrecord
--
ALTER TABLE "TestHistoryRecord" ALTER COLUMN "url" DROP NOT NULL;
--
-- Alter field uuid on testhistoryrecord
--
ALTER TABLE "TestHistoryRecord" ALTER COLUMN "uuid" DROP NOT NULL;
--
-- Alter field v on testhistoryrecord
--
ALTER TABLE "TestHistoryRecord" ALTER COLUMN "v" DROP NOT NULL;
--
-- Alter field meta on testitemhistoryrecord
--
ALTER TABLE "TestItemHistoryRecord" ALTER COLUMN "meta" DROP NOT NULL;
--
-- Alter field v on testitemhistoryrecord
--
ALTER TABLE "TestItemHistoryRecord" ALTER COLUMN "v" DROP NOT NULL;
COMMIT;

    `)
}

exports.down = async (knex) => {
    await knex.raw(`
    BEGIN;
--
-- Alter field v on testitemhistoryrecord
--
ALTER TABLE "TestItemHistoryRecord" ALTER COLUMN "v" SET DEFAULT 1;
UPDATE "TestItemHistoryRecord" SET "v" = 1 WHERE "v" IS NULL;
ALTER TABLE "TestItemHistoryRecord" ALTER COLUMN "v" SET NOT NULL;
ALTER TABLE "TestItemHistoryRecord" ALTER COLUMN "v" DROP DEFAULT;
--
-- Alter field meta on testitemhistoryrecord
--
ALTER TABLE "TestItemHistoryRecord" ALTER COLUMN "meta" SET NOT NULL;
--
-- Alter field v on testhistoryrecord
--
ALTER TABLE "TestHistoryRecord" ALTER COLUMN "v" SET DEFAULT 1;
UPDATE "TestHistoryRecord" SET "v" = 1 WHERE "v" IS NULL;
ALTER TABLE "TestHistoryRecord" ALTER COLUMN "v" SET NOT NULL;
ALTER TABLE "TestHistoryRecord" ALTER COLUMN "v" DROP DEFAULT;
--
-- Alter field uuid on testhistoryrecord
--
ALTER TABLE "TestHistoryRecord" ALTER COLUMN "uuid" SET NOT NULL;
--
-- Alter field url on testhistoryrecord
--
ALTER TABLE "TestHistoryRecord" ALTER COLUMN "url" SET NOT NULL;
--
-- Alter field status_renamed on testhistoryrecord
--
ALTER TABLE "TestHistoryRecord" ALTER COLUMN "status_renamed" TYPE varchar(50) USING "status_renamed"::varchar(50), ALTER COLUMN "status_renamed" SET NOT NULL;
--
-- Alter field slug on testhistoryrecord
--
ALTER TABLE "TestHistoryRecord" ALTER COLUMN "slug" SET NOT NULL;
ALTER TABLE "TestHistoryRecord" ADD CONSTRAINT "TestHistoryRecord_slug_25daa18b_uniq" UNIQUE ("slug");
CREATE INDEX "TestHistoryRecord_slug_25daa18b_like" ON "TestHistoryRecord" ("slug" text_pattern_ops);
--
-- Alter field rating1 on testhistoryrecord
--
ALTER TABLE "TestHistoryRecord" ALTER COLUMN "rating1" SET NOT NULL;
--
-- Alter field pass_field on testhistoryrecord
--
ALTER TABLE "TestHistoryRecord" ALTER COLUMN "pass" TYPE varchar(60) USING "pass"::varchar(60);
--
-- Alter field isEnabled on testhistoryrecord
--
ALTER TABLE "TestHistoryRecord" ALTER COLUMN "isEnabled" SET NOT NULL;
--
-- Add field vir1 to testhistoryrecord
--
ALTER TABLE "TestHistoryRecord" DROP COLUMN "vir1" CASCADE;
COMMIT;

    `)
}
