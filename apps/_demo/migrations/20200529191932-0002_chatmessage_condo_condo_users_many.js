// auto generated by kmigrator
// KMIGRATOR:0002_chatmessage_condo_condo_users_many:IyBHZW5lcmF0ZWQgYnkgRGphbmdvIDMuMC42IG9uIDIwMjAtMDUtMjkgMTQ6MTkKCmZyb20gZGphbmdvLmRiIGltcG9ydCBtaWdyYXRpb25zLCBtb2RlbHMKaW1wb3J0IGRqYW5nby5kYi5tb2RlbHMuZGVsZXRpb24KCgpjbGFzcyBNaWdyYXRpb24obWlncmF0aW9ucy5NaWdyYXRpb24pOgoKICAgIGRlcGVuZGVuY2llcyA9IFsKICAgICAgICAoJ19kamFuZ29fc2NoZW1hJywgJzAwMDFfaW5pdGlhbCcpLAogICAgXQoKICAgIG9wZXJhdGlvbnMgPSBbCiAgICAgICAgbWlncmF0aW9ucy5DcmVhdGVNb2RlbCgKICAgICAgICAgICAgbmFtZT0nY29uZG8nLAogICAgICAgICAgICBmaWVsZHM9WwogICAgICAgICAgICAgICAgKCdpZCcsIG1vZGVscy5BdXRvRmllbGQocHJpbWFyeV9rZXk9VHJ1ZSwgc2VyaWFsaXplPUZhbHNlKSksCiAgICAgICAgICAgICAgICAoJ2FkZHJlc3MnLCBtb2RlbHMuVGV4dEZpZWxkKCkpLAogICAgICAgICAgICBdLAogICAgICAgICAgICBvcHRpb25zPXsKICAgICAgICAgICAgICAgICdkYl90YWJsZSc6ICdDb25kbycsCiAgICAgICAgICAgIH0sCiAgICAgICAgKSwKICAgICAgICBtaWdyYXRpb25zLkNyZWF0ZU1vZGVsKAogICAgICAgICAgICBuYW1lPSdjb25kb191c2Vyc19tYW55JywKICAgICAgICAgICAgZmllbGRzPVsKICAgICAgICAgICAgICAgICgnaWQnLCBtb2RlbHMuQXV0b0ZpZWxkKGF1dG9fY3JlYXRlZD1UcnVlLCBwcmltYXJ5X2tleT1UcnVlLCBzZXJpYWxpemU9RmFsc2UsIHZlcmJvc2VfbmFtZT0nSUQnKSksCiAgICAgICAgICAgICAgICAoJ0NvbmRvX2xlZnRfaWQnLCBtb2RlbHMuRm9yZWlnbktleShkYl9jb2x1bW49J0NvbmRvX2xlZnRfaWQnLCBvbl9kZWxldGU9ZGphbmdvLmRiLm1vZGVscy5kZWxldGlvbi5DQVNDQURFLCByZWxhdGVkX25hbWU9JysnLCB0bz0nX2RqYW5nb19zY2hlbWEuY29uZG8nKSksCiAgICAgICAgICAgICAgICAoJ1VzZXJfcmlnaHRfaWQnLCBtb2RlbHMuRm9yZWlnbktleShkYl9jb2x1bW49J1VzZXJfcmlnaHRfaWQnLCBvbl9kZWxldGU9ZGphbmdvLmRiLm1vZGVscy5kZWxldGlvbi5DQVNDQURFLCByZWxhdGVkX25hbWU9JysnLCB0bz0nX2RqYW5nb19zY2hlbWEudXNlcicpKSwKICAgICAgICAgICAgXSwKICAgICAgICAgICAgb3B0aW9ucz17CiAgICAgICAgICAgICAgICAnZGJfdGFibGUnOiAnQ29uZG9fdXNlcnNfbWFueScsCiAgICAgICAgICAgIH0sCiAgICAgICAgKSwKICAgICAgICBtaWdyYXRpb25zLkNyZWF0ZU1vZGVsKAogICAgICAgICAgICBuYW1lPSdjaGF0bWVzc2FnZScsCiAgICAgICAgICAgIGZpZWxkcz1bCiAgICAgICAgICAgICAgICAoJ2lkJywgbW9kZWxzLkF1dG9GaWVsZChwcmltYXJ5X2tleT1UcnVlLCBzZXJpYWxpemU9RmFsc2UpKSwKICAgICAgICAgICAgICAgICgnbWVzc2FnZScsIG1vZGVscy5UZXh0RmllbGQoKSksCiAgICAgICAgICAgICAgICAoJ2NoYXQnLCBtb2RlbHMuRm9yZWlnbktleShibGFuaz1UcnVlLCBkYl9jb2x1bW49J2NoYXQnLCBudWxsPVRydWUsIG9uX2RlbGV0ZT1kamFuZ28uZGIubW9kZWxzLmRlbGV0aW9uLkRPX05PVEhJTkcsIHJlbGF0ZWRfbmFtZT0nKycsIHRvPSdfZGphbmdvX3NjaGVtYS5jb25kbycpKSwKICAgICAgICAgICAgICAgICgndXNlcicsIG1vZGVscy5Gb3JlaWduS2V5KGJsYW5rPVRydWUsIGRiX2NvbHVtbj0ndXNlcicsIG51bGw9VHJ1ZSwgb25fZGVsZXRlPWRqYW5nby5kYi5tb2RlbHMuZGVsZXRpb24uRE9fTk9USElORywgcmVsYXRlZF9uYW1lPScrJywgdG89J19kamFuZ29fc2NoZW1hLnVzZXInKSksCiAgICAgICAgICAgIF0sCiAgICAgICAgICAgIG9wdGlvbnM9ewogICAgICAgICAgICAgICAgJ2RiX3RhYmxlJzogJ0NoYXRNZXNzYWdlJywKICAgICAgICAgICAgfSwKICAgICAgICApLAogICAgXQo=

exports.up = async (knex) => {
    await knex.raw(`
    BEGIN;
--
-- Create model condo
--
CREATE TABLE "Condo" ("id" serial NOT NULL PRIMARY KEY, "address" text NOT NULL);
--
-- Create model condo_users_many
--
CREATE TABLE "Condo_users_many" ("id" serial NOT NULL PRIMARY KEY, "Condo_left_id" integer NOT NULL, "User_right_id" integer NOT NULL);
--
-- Create model chatmessage
--
CREATE TABLE "ChatMessage" ("id" serial NOT NULL PRIMARY KEY, "message" text NOT NULL, "chat" integer NULL, "user" integer NULL);
ALTER TABLE "Condo_users_many" ADD CONSTRAINT "Condo_users_many_Condo_left_id_5d8a37ce_fk_Condo_id" FOREIGN KEY ("Condo_left_id") REFERENCES "Condo" ("id") DEFERRABLE INITIALLY DEFERRED;
ALTER TABLE "Condo_users_many" ADD CONSTRAINT "Condo_users_many_User_right_id_11f477e6_fk_User_id" FOREIGN KEY ("User_right_id") REFERENCES "User" ("id") DEFERRABLE INITIALLY DEFERRED;
CREATE INDEX "Condo_users_many_Condo_left_id_5d8a37ce" ON "Condo_users_many" ("Condo_left_id");
CREATE INDEX "Condo_users_many_User_right_id_11f477e6" ON "Condo_users_many" ("User_right_id");
ALTER TABLE "ChatMessage" ADD CONSTRAINT "ChatMessage_chat_e0539e32_fk_Condo_id" FOREIGN KEY ("chat") REFERENCES "Condo" ("id") DEFERRABLE INITIALLY DEFERRED;
ALTER TABLE "ChatMessage" ADD CONSTRAINT "ChatMessage_user_f76717e7_fk_User_id" FOREIGN KEY ("user") REFERENCES "User" ("id") DEFERRABLE INITIALLY DEFERRED;
CREATE INDEX "ChatMessage_chat_e0539e32" ON "ChatMessage" ("chat");
CREATE INDEX "ChatMessage_user_f76717e7" ON "ChatMessage" ("user");
COMMIT;

    `)
}

exports.down = async (knex) => {
    await knex.raw(`
    BEGIN;
--
-- Create model chatmessage
--
DROP TABLE "ChatMessage" CASCADE;
--
-- Create model condo_users_many
--
DROP TABLE "Condo_users_many" CASCADE;
--
-- Create model condo
--
DROP TABLE "Condo" CASCADE;
COMMIT;

    `)
}
